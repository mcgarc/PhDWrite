In the previous chapter we described the interaction of a single molcule with a
microwave resonator, but for some experiments a large number of molecules is
desirable. This is particularly true in the field of precise measurement.
Na\"ively we can say that for a measurement of $N$ particles, the signal to
noise ratio (SNR) goes like $\sqrt{N}$, ergo increasing the number of particles
will increase SNR. In this chapter I will present a proposal for how large
ensembles of \CaF{} molecules trapped on a chip could be used to create
non-classical spin-squeezed states~\cite{} (SSS) with potential application in
quantum measurement. I will also suggest how this technique can be adapted to
produce Schr\"odinger cat states, or applied in other architectures.

\section{Spin states of an ensemble}

We begin with an overview of the quantum states of a non-interacting ensemble
of spin-half particles. In the first sub-section I will introduce the coherent
spin state (CSS), where all spins in the ensemble are aligned. I will then
explain how such a state can be converted into a SSS by quantum non-demolition
measurement and why the SSS is a useful tool for precise quantum measurement.

\subsection{Coherent spin states}

For an ensemble of $N$ spin-half particles, we label the Pauli matrices and the
ladder operators for the $i^\text{th}$ spin as $\sigma_*^i$. The spin operator
for this particle is then
%
\begin{equation}
  \mathbf{s}^i = \frac{1}{2}\begin{bmatrix} \sigma^i_x \\ \sigma^i_y \\ \sigma^i_z
\end{bmatrix}.
\end{equation}
%
We now define the collective spin operator
%
\begin{equation}
  \mathbf{S} = \sum_{i=1}^N \mathbf{s}^i.
\end{equation}
%
The common eigenstates of $\mathbf{S}$ and $S_z$ are the familiar angular
momentum eigenstates, which we label $\ket{S,m_S}$, so that $S^2 \ket{S,m} =
S(S+1)\ket{S, m}$ and $S_z \ket{S,m} = m\ket{S, m}$. These are the so-called
Dicke states~\cite{}, which we will see shortly are entangled states of the
spin system.

Consider how we can write down the total state of the system. For an individual
spin, the state can be written as
%
\begin{equation}
  \ket{\psi(\theta, \phi)}_i = \cos\left(\frac{\theta_i}{2}\right)\ket{e}_i +
  e^{i\phi_i}\sin\left(\frac{\theta_i}{2}\right)\ket{g}_i.
  \label{eqn:blochspin}
\end{equation}
%
It is common to represent such a state visually by the Bloch sphere.
The angles $\theta_i$ and $\phi_i$ define a point on a sphere of unit
radius with $\ket{e}_i$ and $\ket{g}_i$ at the poles. The cartesian
representation is given by the expectation value $\langle \mathbf{s}_i
\rangle$.
%
The state of the ensemble is then
%
\begin{equation}
  \ket{\Psi} = \bigotimes_{i=1}^N \ket{\psi}_i
\end{equation}
%
and the Bloch sphere representation is given by the sum of the individual spin
vectors, as illustrated in \cm{TODO}.

An important case is that of the coherent spin state (CSS), that is a
state when all the spins are aligned, so that for all $i$, $\theta_i = \theta$
and $\phi_i = \phi$~\cite{MA201189, Gazeau2009}.
It is useful to consider a system where all spins are initially
in, for example, the ground state. They then undergo the same uniform rotation
into the desired state $\ket{\psi(\theta, \phi)}_i$, which we write as
%
\begin{equation}
  \ket{\Psi(\theta,\phi)} = \mathcal{R}(\theta, \phi)\ket{G}
\end{equation}
%
where $\ket{G} = \bigotimes_{i=1}^N\ket{g}_i$ and similarly for $\ket{E}$. We
represent this visually on the Bloch sphere, now with radius $S=N/2$, in
analogy with the single spin case, as illustrated in \myfigref{squeeze:fig:CSS}. Again
we can represent the vector in a cartesian form as the expectation value
$\langle \mathbf{S} \rangle$. 
%
We note now that $\ket{g} = \ket{S,-S}$ and $\ket{e}=\ket{S,S}$.

% TODO Are ladder operators s_\pm defined elsewhere?
% TODO Cite Binney
% Page 205 onwards in Biney has a discussion of this for N=2 and general S(->J)
%The raising and lowering operators are $S_\pm = (S_x \pm iS_y)/2 =
%\sum_{i=1}^Ns_\pm^i$. It is instructive to consider the state
%when all spins are in the ground state

\begin{figure}[ht]
  \centering
    \includegraphics[width=0.6\textwidth]{figs/squeeze/CSS.pdf}
    \label{squeeze:fig:CSS}
    \caption{
      Graphical representation of a CSS formed by the combined state of $N$
      spins in the same state. In this case the spin states all lie on the
      equator of the Bloch sphere. The uncertainty in the CSS is represented by
      the patch, having a width $\Delta\theta$ (patch width is a guide to the
      eye and not to scale).
  }
\end{figure}

In the next section, we will make particular use of the state
%
\begin{equation}
  \ket{+} = \bigotimes_{i=1}^N \ket{+}_i.
\end{equation}
%
Such a state can be represented on the Bloch sphere as a line pointing along
the $x$ axis ($\theta=\pi/2$, $\phi=0$), as in \cm{ref fig TODO}, or can be
found in terms of $\ket{S,m}$. A CSS can be written in the form 
%
\begin{equation}
  \ket{\Psi} = \sum_{m=-S}^S a_m \ket{S, m}
\end{equation}
%
with the general form of $a_m$ given in \inlineref{PhysRevA.6.2211}. We will
consider only $\ket{+}$, where the probability amplitudes can be understood as
a probabilty of measuring $m_S$ to be some value $\meas{m}$.

For any individual spin, the chances of measuring it to be in $\ket{e}_i$ or
$\ket{g}_i$ are equal. Measuing the state to be in the state $\ket{S, \meas{m}}$
is equivalent to measuring $N_e$ molecules in the excited state, and $N_g = N -
N_e$ in the ground state such that $2\meas{m} = N_e - N_g$ (although note that
we do not determine which spin is in which state). It follows that the
probability of measuring the state to be $\ket{S,\meas{m}}$ will occur with a
binomial probability~\cite{Gazeau2009}
%
% TODO Fix when I use meas{m} and just m
\begin{equation}
  P(m) = \frac{1}{2^N} \binom{N}{m+N/2}
\end{equation}
%
or for large $N$, the binomial is approximated by the Gaussian
%
\begin{equation}
  P(m) \approx\frac{1}{\sqrt{2\pi \Delta_N^2}} e^{-m^2/(2\Delta_N^2)}.
  \label{squeeze:eqn:CSSmprob}
\end{equation}
%
where the variance is $\Delta_N^2 = N/4$. We therefore rewrite the probability
amplitudes of $\ket{+}$ so that
%
\begin{equation}
  \ket{+} = \sum_{m=-S}^S \sqrt{P(m)}\ket{S,m}.
  \label{squeeze:eqn:plusdicke}
\end{equation}

\cm{Check various Delta labels}
%
Note that such a state has expectation values $\langle S_z \rangle = 0$,
$\langle S_z^2\rangle = \Delta_N^2$, and the uncertainty in $S_z$ is consistent
with the usual formula $\Delta_N^2 = \langle S_z^2 \rangle - \langle
S_z\rangle^2$. This uncertainty is the projection noise of a CSS, arising from
the uncertainty in the measurement of the individual spins. We can understand
this in terms of an uncertainty in the cartesian Bloch vector $\langle
\mathbf{S} \rangle$, or as an uncertainty in $\theta$~\cite{PhysRevA.47.3554}
%
% TODO Un-footnote this
\footnote{This can be shown geometrically: consider the angle on the Bloch
sphere between the x-axis and the arrow representing the CSS, call this
$\theta'$ and assume it to be small. Then $\sin
\theta' \approx \tan \theta' = m/S \approx \theta'$. Differentiating both sides
with respect to theta gives $\Delta m / \Delta \theta \approx 1/S$, noting that
$\Delta \theta' = \Delta \theta$.
}
%
\begin{equation}
  \Delta\theta_\text{SQL} = \frac{1}{\sqrt{N}}
\end{equation}
which is known as the standard quantum limit (SQL). By symmetry $\Delta \phi =
\Delta \theta$ (corresponding to uncertainty in $S_y$).
%
\cm{Introuduce term `shot-noise'?}

\cm{Check this makes sense...}
Note that these uncertainties hold only for $\ket{+}$ and other states where
$\theta = \pi$ (states on the equator of the Bloch sphere). For example in the
cases of $\ket{e}$ and $\ket{g}$, $\Delta \theta = 0$~\cite{PhysRevA.47.3554}.

\subsection{Spin-squeezed states}

The uncertainty in $S_z$ $\Delta_\theta$ can be reduced at the expense of
increasing uncertainty in other components of $\mathbf{S}$, so that the
Heisenberg uncertainty principle is obeyed~\cite{}. The resulting state is a
spin-squeezed state (SSS) and is \cm{shown in a fig.} The SSS can be
manipulated by standard microwave spectroscopy techniques, for example by being
rotated onto the an axis of interest \cm{as in another pic}. Such states have
been created and utilised for measurements below the SQL for example in atomic
clocks~\cite{} and \cm{other measurement experiments to be cited}.

\begin{figure}[ht]
  \begin{subfigure}[b]{0.45\textwidth}
    \begin{overpic}[abs, width=\textwidth]{figs/squeeze/SSS.pdf}
      \put(20, 180){(a)}
    \end{overpic}
  \end{subfigure}
  \begin{subfigure}[b]{0.45\textwidth}
    \begin{overpic}[abs, width=\textwidth]{figs/squeeze/SSSrot.pdf}
      \put(20, 180){\textcolor{white}{(b)}}
    \end{overpic}
  \end{subfigure}
    \caption{
      Graphical representations of SSSs. In (a) the state is squeezed along the
      $S_z$ component, reducing $\Delta\theta$ beneath the SQL. In (b) a
      similar state has been rotated by \cm{what pulse?} to move the
      reduced uncertainty into the phase.
  }
  \label{squeeze:fig:SSS}
\end{figure}

It is possible to create a SSS by two main methods. One method is to implelment
a system with a one-axis twisting Hamiltonian~\cite{}, where the SSS is induced
by, for example, collisions between particles \cm{is this right?}. For the
\CaF{} experiment, we propose the creation of a SSS by a quantum non-demolition
(QND) measurement. In such a scheme, measurement of
$m_S$ is performed in such a way that the coherence of the quantum state of the
spin ensemble is preserved, thus reducing the uncertainty $\Delta_\theta$.
Similar experiments to our proposal have been performed for atoms trapped in
optical cavities~\cite{Cox2016, SchleierSmith2011}, however our proposal will 
make use of the CPW microwave cavity for readout, similar to the method for a
single molecule described in section~\ref{mws:readout}.

Our scheme is readliy exemplified by the creation of a maximally-squeezd state
where the uncertainty is reduced as far as possible.  Continuing the disccusion
from the previous section, suppose that we are able to prepare the CSS
$\ket{+}$ and we then measure $S_z$. As previously described, we will measure
$\ket{S, \meas{m}}$ with some probability $P(\meas{m})$. It is useful to frame
such a measurement in a projector formalism. In general, the state of a system
in state $\ket{\Psi}$ following a measurement is~\cite{gerry_knight_2004}
%
\begin{equation}
  \ket{\text{result}} = \frac{\Upsilon\ket{\Psi}}{\sqrt{P_\text{result}}}
  \label{squeeze:eqn:projresult}
\end{equation}
%
where $\Upsilon$ is a projector into the measured state, and
%
\begin{equation}
  P_\text{result} = \bra{\Psi}\Upsilon\ket{\Psi}
\end{equation}
%
is the probability of determining this result, ensuring that
$\ket{\text{result}}$ is normalised. In the case of measuring $S_z$ perfectly
to be $\meas{m}$ the projector is 
%
\begin{equation}
  \Upsilon_0(\meas{m}) = \ket{S, \meas{m}}\bra{S, \meas{m}}.
\end{equation}
%
which, as discussed already, yields $\ket{S,\meas{m}}$ with probability
$P(\meas{m})$.

At this point it is worth pointing out that if we can realise such a
measurement then we are done. The Dicke states are entangled states with a
reduced uncertainty (except for $\ket{g}$ and $\ket{e}$). \cm{CHECK THIS!} The
Dicke states can be found by repeated application of the ladder operators, and
are the superposition of all possible states with $N_e$ atoms in $\ket{e}$ and 
$N_g = N - N_e$ atoms in $\ket{g}$. We can therefore write in general that
%
\begin{equation}
  \ket{\frac{N}{2}, m} = \binom{N}{N_e}^{-\frac{1}{2}}\sum_{\pi \in \Pi}
  \bigotimes_{i=1}^{N_e} \sigma_x^{\pi_i} \ket{g}
\end{equation}
%
with $N_e=(N/2)+m$.
%
This is perhaps more easily explored by example, which we can 
borrow from~\inlineref{Cox2016}. Consider the case where
$N=4$ and $\meas{m}=0$. This results in the state $\ket{2, 0}$ which is
%
\begin{equation}
  \ket{2,0} = \frac{1}{\sqrt{6}}(\ket{eegg} + \ket{egeg} + \ket{egge} +
  \ket{geeg} + \ket{gege} + \ket{ggee}).
\end{equation}
%
Note that every possible combination of two excited, and two ground state spins
appear in equal superposition. We can now see that this state is a maximally
entangled state, and would be represented on the Bloch sphere as a ring around
the equator~\cite{Cox2016}.
%
Such a state necessarily has zero uncertainty in $S_z$, since this is the
operator that has been measured. The state is therefore maximally squeezed and
also has maximum uncertainty in $S_x$.  Hence we have demonstrated that a
measurement of $\ket{+}$ can produce a SSS.

\cm{A note on the fact that it is entanglement (spin-correlations) that reduce
  the uncertainty WITH CITE.}

Measuring $m$ exactly produces a maximally squeezed state, but precise
determination of this value is not always possible, but measuring $m$ with some
uncertainty $\Delta m < \Delta_N$ will still produce a state with reduced
uncertainty in $S_z$, as illustrated in \cm{fig. TODO and CITE}. Here the
measurement projector is ~\cite{MAURODARIANO2003205, Vanner16182, Cox2016}
%% NOTE Don't bother citing Zhang2019 because it just cites this Vanner paper
%
\begin{equation}
  \Upsilon_{\Delta_{S_z}}(\meas{m}) = \frac{1}{\sqrt{\pi\Delta_N^2}}\exp\left[
    -\frac{(S_z-\meas{m})^2}{2\Delta_{S_z}^2}\right].
  \label{squeeze:eqn:squeezeproj}
\end{equation}
%
representing a measurement where we have some Gaussian uncertainty
($\Delta_{S_z}$) in the measured result.  In the next section we will see how
to implement this measurement in a \CaF{} chip system to create squeezed
states.

\section{Spin ensemble coupled to a cavity}

\subsection{Spin Hamiltonian}

We now turn to the case of $N\gg1$ spins coupled strongly to a
nearby microwave cavity.  Assume that the coupling between each spin and the
resonator photons is the same (that is, the coupling is homogeneous), then the
ensemble is described by the Tavis-Cummings Hamiltonian~\cite{Kirton2019}
%
\begin{equation}
  H_\text{TC}=  \hbar \omega_c a^\dagger a + \sum_{i=1}^N\left[
    \frac{\hbar\omega_0}{2}\sigma_z^i +\frac{\hbar\Omega}{2\sqrt{N}}(a^\dagger
    \sigma^i_- + a\sigma^i_+)\right]
\end{equation}
%
in direct analogy to~\myeqref{theory:eqn:JCH}, and similar to optical
cavity experiments~\cite{Cox2016, SchleierSmith2011}.
%
We can also write this Hamiltonian in terms of the collective spin operator
%
\begin{equation}
  H_\text{TC} = \hbar\omega_c a^\dagger a + \hbar\omega_0 S_z +
  \frac{\hbar\Omega}{2}(a^\dagger S_- + aS_+).
\end{equation}
%
Consider the dispersive r\'egime ($|\Delta|\gg g$) and apply the transformation
by unitary operator
%
\begin{equation}
  U_\text{E} = \exp \left[\frac{g}{\Delta}(aS_+ - a^\dagger S_-)\right]\
\end{equation}
%
for Hamiltonian
%
\begin{equation}
  H_\text{E}= U_\text{E}H_\text{TC}U_\text{E}^\dagger \approx 
    \hbar \omega_c a^\dagger a + 
    \hbar\left(\omega_c + \frac{g^2}{\Delta}\right)S_z + 
    \frac{\hbar g^2}{\Delta}S_z a^\dagger a.
  \label{eqn:He}
\end{equation}
%
This is an extension of the transformation (\myeqref{mws:eqn:Utransform}) and 
resulting Hamiltonian (\myeqref{mws:eqn:UHU}) for the single-molecule case.

This extension is valid since the mathematics of the transformation is exactly
the same as for the single-spin case. The operator $\mathbf{S}$ has the same
commutation relations as the analogous $\mathbf{s}^i$. Once again, the final
term will allow the information transfer for our QND measurements.

\subsection{Quantum non-demolition measurement of the spin state}

We now apply the readout method described for a single spin in
section~\ref{mws:readout} to performing a quantum non-demolition (QND)
measurement of the ensemble state.
%
We will show that the state of the system can be entangled with light in the
resonator, in exact analgogy with the single-molecule case. Measurement of this
light can then implement the squeezing projector in
\myeqref{squeeze:eqn:squeezeproj}.

The moecules can be prepared in the state $\ket{+}$ by the usual microwave
spectroscopy techniques described in \inlineref{WilliamsMagnetic2018}. The
state of the spin ensemble at time $t=0$ is then
%
\begin{equation}
  \ket{\Psi(0)} = \sum_{m=-S}^S \sqrt{P(m)} \ket{S, m}\ket{\alpha}
\end{equation}
%
which evolves during the interaction with the resonator over a time $T$ to
%
\begin{equation}
  \ket{\Psi(T)} = \exp\left(-iH_\text{int}T/\hbar\right)\ket{\Psi(0)}
\end{equation}
%
where the interaction Hamiltonian is
%
\begin{equation}
  H_\text{int} = \hbar \frac{g^2}{\Delta} S_z a^\dagger a.
\end{equation}
%
After the pulse, we therefore have the state
%
\begin{equation}
  \ket{\Psi(T)} = \sum_{m=-S}^S \sqrt{P(m)} e^{-i\nu T S_z
  a^\dagger a} \ket{S, m}\ket{\alpha}
\end{equation}
%
with $\nu = g^2/\Delta$ as before. It is now straightforward to show that
the state of the spin ensemble is entangled with the state of the light field,
in analogy to equations~\ref{mws:eqn:evolve1}--\ref{mws:eqn:entangled}
%
\begin{align}
  \ket{\Psi(T)} &= e^{-\frac{|\alpha|^2}{2}}\sum_{m=-S}^S \sum_{n=0}^\infty \sqrt{P(m)}
   \frac{\alpha^n}{\sqrt{n!}} e^{-i\nu T S_z a^\dagger a} \ket{S, m} \ket{n}
   \\
  &= e^{-\frac{|\alpha|^2}{2}}\sum_{m=-S}^S \sum_{n=0}^\infty \sqrt{P(m)}
  \frac{\alpha^n}{\sqrt{n!}} e^{-i\nu Tm n} \ket{S, m} \ket{n} \\
  &= \sum_{m=-S}^S \sqrt{P(m)} \ket{S, m} \left( e^{-\frac{|\alpha|^2}{2}}
  \sum_{n=0}^\infty \frac{(\alpha e^{-i\nu T m})^n}{\sqrt{n!}}\ket{n}\right)
  \\
  &= \sum_{m=-S}^S \sqrt{P(m)} \ket{S, m}\ket{\alpha e^{-i\nu T m}}.
\end{align}

Measuring the phase of the light leaving the cavity (for example with a
homodyne detector) will therefore tell us something about the state of the
ensemble. Notably, the information gained tells us only about the entire state
of the ensemble, and not about any individual spins. Therefore the quantum
coherence is conserved throughout this process.
% TODO I'm not convinced by this assertion. CITE? Actually check... 

The phase of the light is again extracted by the homodyne measurement, which
was described in section~\ref{mws:readout}. We will once again assume short
interaction time so that $T\approx\kappa^{-1}$ and take the strong dispersive
limit ($|\Delta| \gg g^2/\kappa$). The difference in photon numbers arriving at
the homodyne detectors is therefore related to the spin ensemble by
%
% TODO Missing a factor of what I confusingly called kappa before (see mws
% TODO on calculating expectation)
\begin{equation}
  \langle c^\dagger c - d^\dagger d\rangle = 2|\alpha||\beta|
  \frac{g^2}{\Delta\kappa}\langle S_z\rangle.
  \label{eqn:homomeas}
\end{equation}

It is clear that performing the homodyne measurement is equivalent to
performing a measurement of the $S_z$ operator for the spins. In order to
distinguish between neighbouring $S_z$ states, we must be able to resolve
photon differences smaller than $2|\alpha||\beta|g^2/(\Delta\kappa)$. Since
$|\beta|$ is large, this photon difference is amplified to make the measurement
possible. In the event that neighbouring states are easily distinguishable, we
can create sates of the form $\ket{S,m_S}$. However if there is some
uncertainty in the homodyne measurement $\Delta_{S_z}$ then the homodyne
measurement realises the projector given in \myeqref{squeeze:eqn:squeezeproj}. 
%
The result of the homodyne heralds the creation of a state
%
\begin{equation}
  \ket{\Phi(\meas{m}, \Delta)} = \frac{\Upsilon_{\Delta_{S_z}}
  (\meas{m})\ket{+}}{ \sqrt{P_{\meas{m}}} }
\end{equation}
%
At this point we have dropped the ket representing the state of the light.
Although we have a QND measurement on the spins, this process destroys the
light state, and so it is no longer relevant.

This resulting state can be found as follows. Begin by calculating the
numerator, that is the homodyne projector acting on $\ket{\Psi(T)}$
%
\begin{align}
  \Upsilon_{\Delta_{S_z}}(\meas{m}\ket{+} &=
  \sum_{m=-S}^{S}\sqrt{P(m)}\Upsilon(\meas{m})\ket{S,m}\ket{\alpha e^{-i\nu Tm}}.
  &=\frac{1}{\sqrt{\pi\Delta_N^2}}\sum_{m=-S}^S \sqrt{P(m)} \exp\left[
    -\frac{(m-\meas{m})^2}{2\Delta_N^2}\right]\ket{S,m}.
\end{align}
%
Which we can immediately use to find the probability of measuring $\meas{m}$
%
%TODO Fix probability nomenclature throughout
\begin{align}
  \tilde{P}(\meas{m}) &= \bra{\Psi(T)}\Upsilon(\meas{m})\ket{\Psi(T)}\\
  & = \sum_{m'=-S}^S \sum_{m=-S}^S \sqrt{P(m')P(m)}\bra{S,
  m'}\Upsilon(\meas{m})\ket{S, m} \\
  & = \sum_{m'=-S}^S \sum_{m=-S}^S \sqrt{P(m')P(m)}
  \frac{1}{\sqrt{2\pi\Delta_{S_z}^2}}\exp\left[-\frac{(m-\meas{m})^2}{2\Delta_{S_z}^2}\right] 
  \bra{S, m'}\ket{S, m} \\
  &= \sum_{m=-S}^{S} P(m) 
  \frac{1}{\sqrt{2\pi\Delta_{S_z}^2}}\exp\left[-\frac{(m-\meas{m})^2}{2\Delta_{S_z}^2}\right] .
\end{align}
%
taking the large $N$ limit, and approximating the summation as an integral,
this last equality becomes a convolution of two Gaussians, so that
%
\begin{equation}
  \tilde{P}(\meas{m}) = \frac{1}{\sqrt{2\pi(\Delta_N^2 + \Delta_{S_z}^2)}}\exp\left[
    -\frac{\meas{m}^2}{2(\Delta_N^2 + \Delta_{S_z}^2)}\right].
\end{equation}
%
This becomes eqn.~\ref{squeeze:eqn:CSSmprob} in the limit that $\Delta_{S_z} \to 0$
i.e., when the uncertainty in the homodyne detection is small we measure the
state $m$ according to its expected distribution. If we have some large
uncertainty in our measurement then the distribution that we measure is not the
same as the expected distribution.

Finally we calculate the state resulting from the measurement using
\myeqref{squeeze:eqn:projresult}, again taking the
approximation that we are in the limit of large $N$, and also that
$\Delta_{S_z}^2 \ll \Delta_N^2$,
%
\begin{equation}
  \ket{\Psi_{\meas{m}}} =
  \sum_{m=-S}^S\left\{\frac{1}{\sqrt{2\pi\Delta_{S_z}^2}} \exp\left[-\frac{(m -
  \meas{m})^2}{2\Delta_{S_z}^2}\right]\right\}^\frac{1}{2} \ket{S,m}
\end{equation}
%
% TODO Better reference
which is a state that has been squeezed in comparison to the initial spin
state. The $S_z$ distribution now has a width $\Delta_{S_z}^2$ rather than
$\Delta_N^2$, as illustrated in fig~\ref{squeeze:fig:blochsqueezed}. Since the
Heisenberg uncertainty principle must be obeyed, the reduction of uncertainty
in $S_z$ increases the uncertainty in $S_y$.

The squeezing is parameterised by the parameter~\cite{PhysRevA.46.R6797}
%
\begin{equation}
  \chi^2 = \left(\frac{\sqrt{N}/2}{\Delta S_z}\frac{|S|}{N/2}^2\right)^2
\end{equation}
%
where the first fraction inside the brackets is the ratio of the projection
noise to the reduced uncertainty, and the second fraction accounts for any
decoherence that occurs during the measurement. Decoherence or loss of
particles will result in a decrease in the length of the Bloch vector $|S|$,
and hence reduce the precision of a measurement. Hence any useful squeezing
must reduce such effects. Squeezing occurs in the case that $\chi^2 >1$, which
is known as the Wineland criterion.

\section{Implementation on \CaF{} chip}

For the \CaF{} chip implementation of this squeezing procedure, we propose that
the stretched-states can be used for the ground and excited states, as in the
previous chapter. So $\ket{g} = \ket{N=0, F=1, m_F=1}$ and $\ket{e} =
\ket{1, 2, 2}$. We assume that the resonator used is a high-$Q$ ($Q\sim10^6$)
superconducting resonator, with a superconducting dimple trap, so that
arbitrarily high trapping frequencies and trap depths are achievable.
%
\cm{Make sure $g$, $\Delta$ and $\kappa$ are written down somewhere. Do I need
  to really point at them or repeat here?}

The squeezing that can be achieved on the chip is then dependent on three main
factors:
%
\begin{enumerate}
    \item The number of molecules that can be trapped, $N$
    \item The uncertainty in the homodyne measurement.
    \item The number of spins that decay during the interrogation time,
\end{enumerate}

We have already addressed the number of molecules that it is possible to trap
on a chip in detail in chapter \cm{ref chapter}. Maximising the phase-space
density of molecules before trapping on the chip will increase $N$, but we can
certainly expect to be working in the r\'egime of $N\gtrapprox10^3$. We also
expect that the majority of these spins will remain trapped over an
interrogation time of $T\sim\kappa^{-1}$, since the stretched states have
lifetimes in the trap on the order of several hundred milliseconds.

% TODO More formal treatment also in https://www.nature.com/articles/s41586-020-2243-7
% which might be nice to cite elsewehre too
The uncertainty in the homodyne measurement determines the uncertainty in
$S_z$, and hence the extent of the squeezing. However, relating these two
quantities analytically is non-trivial (although a more formal treatment can be
found in \inlineref{Zhang2019}) and will largely depend on experimental
factors, including thermal and electronic noise. However using
\myeqref{squeeze:eqn:homomeas} we can make a good approximation that for
squeezing of width $\Delta_{S_z}$, we require measurement uncertainty in photon
number
%
\begin{equation}
  \Delta_\gamma < 2|\alpha||\beta| \frac{g^2}{\Delta\kappa}\Delta_{S_z}.
\end{equation}
%
A na\"ive approach to reducing the required uncertainty for squeezing might be
to simply increase the LO amplitude ($|\beta|$) arbitraritly. Note however that
the noise associated with the measurement of photons is Poissonian, and goes
like the square root of the photon number, which is exactly $|\beta|$.
Therefore increasing $|\beta|$ on the right side of the inequality makes
reduction of $\Delta_\gamma$ on the left side harder.

%We estimate $|\alpha|^2$, the mean number of photons in the resonator as follows,
%assume a $P=\SI{1}{\milli\watt}$ pulse of duration $T=\kappa$, then the total
%energy is
%%
%\begin{equation}
%  PT=|\alpha|^2\hbar\omega_0
%\end{equation}
%%
%therefore $|\alpha|^2\sim10^{14}$.

It is therefore instructive to consider the quantity $\Delta_\gamma/|\beta|$ as
a function of the probe amplitude ($|\alpha|$) and the other parameters of the
cavity system. The requisite photon uncertainty to achieve a given squeezing
can be found numerically. The results for a \SI{-50}{\dbm} probe power and
$N=200$ are shown in \myfigref{squeeze:fig:squeezeuncert}. This figure shows
the squeezing by reduction of $\Delta_{S_z}$ for lower $\Delta_\gamma/|\beta|$.
We also see the corresponding increase in the uncertainty in the other
components of $\mathbf{S}$, which we parameterise as $\Delta_{S_{x,y}} =
\sqrt{\Delta_{S_x}^2 + \Delta_{S_y}^2}$. This result demonstrates that the
experiment operates in the r\'egime where squeezing is certainly possible with
conventional microwave detectors~\cite{Dicke1946m, PhysRevD.88.035020}, however
this does not account for other sources of noise that may arise during the
experiment.

\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
        enlargelimits=true,
        xlabel=$\Delta_\gamma/|\beta|$,
        ylabel=$\Delta_{S_i}$,
        width=0.7\textwidth,
        height = 0.4\textwidth,
        %legend pos=outer north east
    ]
      \addplot [thick, black] table {figs/squeeze/squeezing.dat};
      \addlegendentry{$\Delta_{S_z}$}
      \addplot [style=thick, color=blue] table [y index=2]
      {figs/squeeze/squeezing.dat};
      \addlegendentry{$\Delta_{S_{x,y}}$}
    \end{axis}
  \end{tikzpicture}
  \caption{The squeezing (reduction in $\Delta_{S_z}$) and anti-squeezing
  (increase in other components of $\Delta_S$) versus the uncertainty in
  homodyne photon detection.
  }
  \label{mws:fig:squeezeuncert}
\end{figure}

Finally, we rephrase the squeezing in terms of the squeezing parameter \cm{ref
eqn}. We again anticipate from the free space microwave spectrscopy
experiments~\cite{WilliamsMagnetic2018} that there will be minimal dephasing
and loss of spins over the timescale of our experiment. We present the
squeezing parameter for various decreases of $|S|$ in \cm{figure}.

% Data generated by squeeze/2022-02-22_squeeze.nb
\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
        enlargelimits=true,
        ylabel=$\chi^2$,
        xlabel=$\Delta_\gamma / |\beta|$,
        width=0.7\textwidth,
        height = 0.4\textwidth,
        legend pos=outer north east
        %x tick label style={/pgf/number format/.cd, set thousands separator={}}
    ]
      % Hack legend entry
      \addlegendimage{empty legend}
      \addlegendentry{\hspace{-.6cm} $|S|/(N/2)$}
      \addplot [thick, black] table {figs/squeeze/chisqds.dat};
      \addlegendentry{1}
      \addplot [style=thick, color=blue] table [y index=2] {figs/squeeze/chisqds.dat};
      \addlegendentry{0.9}
      \addplot [style=thick, color=pink] table [y index=3] {figs/squeeze/chisqds.dat};
      \addlegendentry{0.75}
      \addplot [style=thick, color=purple] table [y index=4] {figs/squeeze/chisqds.dat};
      \addlegendentry{0.5}
    \end{axis}
  \end{tikzpicture}
  \caption{The Wineland criterion $\chi^2$ is shown versus the homodyne
  measurement uncertainty to pump noise ratio $\Delta_\gamma/|\beta|$ for
  various spin losses $|S|/(N/2)$. We take
  $g/2\pi = \SI{125}{\kilo\hertz}$, $\kappa/2\pi = \SI{21}{\kilo\hertz}$,
  % for this power value, could cite
  % goppl or https://sites.astro.caltech.edu/~jonas/Theses/Jiansong_Gao_08.pdf
  $P=\SI{-50}{\dbm}$. 
  }
  \label{squeeze:fig:wineland}
\end{figure}

\section{Outlook}

Although the main concept presented here has been to prepare non-classical SSS
for measurement, this proposal has several possible routes for further
development.

% TODO Find a cite
One example is to produce Schr\"odinger cat states, which have applications in
\cm{??}. Such states can be generated by performing the same procedure as
outlined above, except measuring the $X$ quadrature of the light rather than
the $Y$ quadrature, by choosing the phase to be $\varphi=$\cm{?}. Since $X =
|\alpha|\cos(\nu \langle S_z \rangle)$ and cosine is an even function, this
prevents the gain on any information of the sign of the measured $S_z$ value.
The resulting state can be represented on the Bloch sphere as a pair of SSSs
with equal widths, at $m_S=\pm\meas{m}$, as illustrated in \cm{fig}.

% Big cite https://iopscience.iop.org/article/10.1070/PU1980v023n08ABEH005024
Another possibility is to implement a maser system demonstrating superradiance.
This idea was originally proposed in \inlineref{}. % Dicke 1954
In a two-level system in population inversion it is possible to observe
a rapid collective decay into the ground state. The decay rate scales as
%
\begin{equation}
  \tau_\text{Dicke} \propto \frac{1}{N}
\end{equation}
% 
and can produce a bright pulse of light at the resonant frequency. The pulse
will travel favourably in the longest dimension of the spin ensemble, which can
be easily controlled by the shape of the trapping wires. A further idea is to
investigate superradiance in close proximity to a microwave resonator, similar
to what is discussed in \inlineref{}.
% https://journals.aps.org/prb/pdf/10.1103/PhysRevB.81.041101



% TODO para on two-mode squeezing
% https://journals.aps.org/pra/pdf/10.1103/PhysRevA.99.012325

% TODO para on other architectrues (e.g. NV centres?)
